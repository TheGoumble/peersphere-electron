<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self'; connect-src 'self' https://peersphere-backend-691058527412.us-central1.run.app"
    />
    <title>PeerSphere - Student Study Platform</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="container">
      <!-- Sidebar -->
      <div class="sidebar">
        <h1>PeerSphere</h1>
        <p>Your collaborative study platform. Connect with classmates, share notes, create flashcards, and succeed together.</p>
      </div>
      
      <!-- Auth Content -->
      <div class="content" id="authContent">
        <div class="tabs">
          <button class="tab active" data-tab="login" onclick="switchTab('login')">Login</button>
          <button class="tab" data-tab="register" onclick="switchTab('register')">Register</button>
        </div>
        
        <div id="messageBox" class="message"></div>
        
        <!-- Login Form -->
        <div id="loginForm" class="form-container active">
          <form onsubmit="handleLogin(event)">
            <div class="form-group">
              <label for="loginEmail">Email</label>
              <input type="email" id="loginEmail" required placeholder="you@example.com" />
            </div>
            <div class="form-group">
              <label for="loginPassword">Password</label>
              <input type="password" id="loginPassword" required placeholder="Enter your password" />
            </div>
            <button type="submit" id="loginBtn" data-original-text="Login">Login</button>
          </form>
        </div>
        
        <!-- Register Form -->
        <div id="registerForm" class="form-container">
          <form onsubmit="handleRegister(event)">
            <div class="form-group">
              <label for="registerName">Full Name</label>
              <input type="text" id="registerName" required placeholder="John Doe" />
            </div>
            <div class="form-group">
              <label for="registerEmail">Email</label>
              <input type="email" id="registerEmail" required placeholder="you@example.com" />
            </div>
            <div class="form-group">
              <label for="registerPassword">Password</label>
              <input type="password" id="registerPassword" required minlength="6" placeholder="At least 6 characters" />
            </div>
            <button type="submit" id="registerBtn" data-original-text="Create Account">Create Account</button>
          </form>
        </div>
      </div>
      
      <!-- Dashboard (hidden initially) -->
      <div class="dashboard" id="dashboard">
        <h2>Welcome to PeerSphere! ðŸŽ‰</h2>
        <div class="user-info">
          <h3>User Information</h3>
          <p><strong>Name:</strong> <span id="userName"></span></p>
          <p><strong>Email:</strong> <span id="userEmail"></span></p>
          <p><strong>User ID:</strong> <span id="userId"></span></p>
        </div>
        <button class="logout-btn" onclick="handleLogout()">Logout</button>
      </div>
    </div>
    
    <!-- Load JS modules -->
    <script src="api.js"></script>
    <script src="session-manager.js"></script>
    <script src="auth-manager.js"></script>
    <script src="ui-manager.js"></script>
    <script src="app.js"></script>
    <script>
      // Initialize the application
      let app;
      
      document.addEventListener('DOMContentLoaded', () => {
        app = new App();
      });

      // Expose functions for onclick handlers
      function switchTab(tab) {
        if (app) app.switchTab(tab);
      }

      function handleLogin(event) {
        if (app) app.handleLogin(event);
      }

      function handleRegister(event) {
        if (app) app.handleRegister(event);
      }

      function handleLogout() {
        if (app) app.handleLogout();
      }
    </script>
  </body>
</html>
